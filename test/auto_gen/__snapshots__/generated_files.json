{
  "files": [
    {
      "path": "ecommerce_transaction_interactions_features_1/packages.yml",
      "content": "\npackages:\n  - git: \"https://github.com/snowplow/dbt-snowplow-utils.git\"\n    revision: \"refactor/time-based-macros\"\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/dbt_project.yml",
      "content": "name: 'ecommerce_transaction_interactions_features_1'\nversion: '0.0.1'\nconfig-version: 2\n\nrequire-dbt-version: [\">=1.6.0\", \"<2.0.0\"]\n\nprofile: 'snowplow_autogen'\n\ndispatch:\n  - macro_namespace: dbt\n    search_order: ['snowplow_utils', 'dbt']\n\nmodel-paths: [\"models\"]\nanalysis-paths: [\"analyses\"]\ntest-paths: [\"tests\"]\nseed-paths: [\"seeds\"]\nmacro-paths: [\"macros\"]\nsnapshot-paths: [\"snapshots\"]\ndocs-paths: [\"docs\"]\n\ntarget-path: \"target\"\nclean-targets:\n  - \"target\"\n  - \"dbt_packages\"\n  - \"logs\"\n  \nmodels:\n  ecommerce_transaction_interactions_features_1:\n    +materialized: table\n    +file_format:  \"{{ 'delta' if target.type not in ['spark'] else 'iceberg'}}\"\n    +incremental_strategy: \"{{ None if target.type not in ['spark'] else 'merge' }}\"\n    +bind: false\n    base:\n      +tags: \"base\"\n      manifest:\n        +schema: \"snowplow_manifest\"\n      scratch:\n        +schema: \"scratch\"\n        +tags: \"scratch\"\n    filtered_events:\n      +schema: \"derived\"\n      +tags: \"ecommerce_transaction_interactions_features_1_incremental\"\n      scratch:\n        +schema: \"scratch\"\n        +tags: \"scratch\"\n    daily_aggregates:\n      +schema: \"derived\"\n      +tags: \"ecommerce_transaction_interactions_features_1_incremental\"\n      scratch:\n        +schema: \"scratch\"\n        +tags: \"scratch\"\n      manifest:\n        +schema: \"snowplow_manifest\"\n    attributes:\n      +schema: \"derived\"\n      +tags: \"ecommerce_transaction_interactions_features_1_incremental\"\n\nvars:\n  ecommerce_transaction_interactions_features_1:\n\n    # OPERATION & LOGIC\n    \n    # filtered_events\n    snowplow__start_date: '2025-01-01' # date from where it starts looking for events based on both load and derived_tstamp\n    snowplow__app_id: [] # already gets applied in base_events_this_run\n    snowplow__backfill_limit_days: 1 # limit backfill increments for the filtered_events_table\n    \n    # daily_aggregates\n    snowplow__late_event_lookback_days: 5 # the number of days to allow for late arriving data to be reprocessed fully in the daily aggregate table\n    snowplow__min_late_events_to_process: 1 # the number of total daily events that have been skipped in previous runs, if it falls within the late_event_lookback_days, if the treshold is reached, those events will be processed in the daily aggregate model\n    \n    snowplow__allow_refresh: false # if true, the snowplow_incremental_manifest will be dropped when running with a --full-refresh flag\n\n    # WAREHOUSE & TRACKER\n    \n    snowplow__dev_target_name: dev\n    snowplow__databricks_catalog: \"hive_metastore\"\n    # snowplow__atomic_schema: 'atomic' # Only set if not using 'atomic' schema for Snowplow events data\n    # snowplow__database: # Only set if not using target.database for Snowplow events data -- WILL BE IGNORED FOR DATABRICKS\n    # snowplow__events_table: \"events\" # Only set if not using 'events' table for Snowplow events data\n    snowplow__events: \"{{ source('atomic', 'events') }}\" # for dev use only\n    \non-run-start:\n  - \"{{ snowplow_utils.snowplow_delete_from_manifest(var('models_to_remove',[])) }}\"\n\non-run-end:\n  - \"{{ snowplow_utils.snowplow_incremental_post_hook_t(package_name='ecommerce_transaction_interactions_features_1', incremental_manifest_table_name='ecommerce_transaction_interactions_features_1_incremental_manifest', base_events_this_run_table_name='ecommerce_transaction_interactions_features_1_base_events_this_run') }}\"\n  - \"{{ snowplow_utils.grant_usage_on_schemas_built_into(var('snowplow__grant_schemas', true)) }}\"\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/macros/get_cluster_by_values.sql",
      "content": "{#\nCopyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{% macro get_cluster_by_values(model) %}\n    {{ return(adapter.dispatch('get_cluster_by_values', 'ecommerce_transaction_interactions_features_1')(model)) }}\n{% endmacro %}\n\n\n{% macro default__get_cluster_by_values(model) %}\n    {% if model == 'dummy' %}\n        {{ return(snowplow_utils.get_value_by_target_type(bigquery_val=[\"session_identifier\"], snowflake_val=[\"to_date(start_tstamp)\"])) }}\n    {% else %}\n        {{ exceptions.raise_compiler_error(\n      \"Snowplow Error: Model \"~model~\" not defined for cluster by.\"\n      ) }}\n    {% endif %}\n{% endmacro %}\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/macros/get_limits_for_attributes.sql",
      "content": "{#\nCopyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{% macro get_limits_for_attributes() %}\n\n{# upper limit only applies to last n day aggregates in case the user does not want to include current date in the aggregations #}\n{# lower limit is only implemented for reducing unnecessary scans in case there are only last n day aggregate attributes #}\n  \n  {% set limits_query %}\n  \n    with base as (\n      \n      select\n        '{{ var('snowplow__start_date', '2025-01-01') }}' as lower_limit,\n        coalesce(max(event_date), '{{ var('snowplow__start_date', '2025-01-01') }}') as upper_limit\n        \n      from {{ ref('ecommerce_transaction_interactions_features_1_daily_aggregates') }}\n      \n      group by 1\n    )\n    \n    , upper_limit_changes as (\n      \n      select\n        lower_limit,\n        {% if not var('snowplow__include_current_day_in_windows', false) %} \n          case when upper_limit = current_date then {{dbt.dateadd('day', -1, \"'\"~upper_limit~\"'\")}} else upper_limit end as upper_limit\n        {% else %}\n          upper_limit\n        {% endif %}\n        \n      from base\n    )\n    \n    select\n      lower_limit,\n      upper_limit\n\n    from upper_limit_changes\n\n  {% endset %}\n\n  {% set limit_results = run_query(limits_query)%}\n\n  {% if execute %}\n    {% if limit_results|length == 0  %}\n      {{ exceptions.raise_compiler_error(\"Error: No limits returned\") }}\n    {% else %}\n      {% set lower_limit = \"'\"~limit_results.columns[0].values()[0]~\"'\" %}\n      {% set upper_limit = \"'\"~limit_results.columns[1].values()[0]~\"'\" %}\n      {{ log(this.table ~ \": processing daily events between \" ~ lower_limit ~ \" and \" ~ upper_limit, info=write_limits_to_stdout) }}\n      {{ return([lower_limit, upper_limit]) }}\n    {% endif %}\n  {% else%}\n    {{ return(['','']) }}\n  {% endif %}\n\n{% endmacro %}\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/macros/allow_refresh.sql",
      "content": "{#\nCopyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{# Default: Allow refresh in dev, block refresh otherwise. dev defined by snowplow__dev_target_name #}\n\n{% macro allow_refresh() %}\n  {{ return(adapter.dispatch('allow_refresh', 'ecommerce_transaction_interactions_features_1')()) }}\n{% endmacro %}\n\n{% macro default__allow_refresh() %}\n\n  {% if flags.FULL_REFRESH == True %}\n    {% set allow_refresh = snowplow_utils.get_value_by_target(\n                                      dev_value=none,\n                                      default_value=var('snowplow__allow_refresh'),\n                                      dev_target_name=var('snowplow__dev_target_name')\n                                      ) %}\n  {% else %}\n    {% set allow_refresh = none %}\n  {% endif %}\n\n  {{ return(allow_refresh) }}\n\n{% endmacro %}\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/configs/base_config.json",
      "content": "{\n    \"events\": [\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_ping/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/page_view/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/ad_break_end_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/ad_break_start_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/ad_complete_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/ad_quartile_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/ad_skip_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/ad_start_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/buffer_end_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/buffer_start_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/end_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/pause_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/percent_progress_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/ping_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/play_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/playback_rate_change_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/quality_change_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/ready_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/seek_end_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/seek_start_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.media/volume_change_event/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/change_form/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow/focus_form/jsonschema/1-0-0\",\n        \"iglu:com.snowplowanalytics.snowplow.ecommerce/snowplow_ecommerce_action/jsonschema/1-0-0\"\n    ],\n    \"properties\": [\n        {\n            \"geo_country\": \"geo_country\"\n        },\n        {\n            \"geo_timezone\": \"geo_timezone\"\n        },\n        {\n            \"contexts_nl_basjes_yauaa_context_1[0]:operatingSystemName\": \"operating_system_name\"\n        },\n        {\n            \"contexts_nl_basjes_yauaa_context_1[0]:deviceClass\": \"device_class\"\n        },\n        {\n            \"mkt_source\": \"mkt_source\"\n        },\n        {\n            \"mkt_medium\": \"mkt_medium\"\n        },\n        {\n            \"refr_source\": \"refr_source\"\n        },\n        {\n            \"refr_medium\": \"refr_medium\"\n        },\n        {\n            \"page_url\": \"page_url\"\n        },\n        {\n            \"contexts_com_snowplowanalytics_snowplow_ecommerce_transaction_1[0]:revenue\": \"revenue\"\n        }\n    ],\n    \"periods\": [\n        \"P7DT0H0M0.000000S\"\n    ],\n    \"transformed_attributes\": [\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": null,\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"count\",\n                \"column_name\": \"count_page_view\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"sum\",\n                \"column_name\": \"page_view_events_count_last_7_days\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"period\",\n                            \"operator\": \">\",\n                            \"value\": 7\n                        }\n                    ],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": null,\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"count\",\n                \"column_name\": \"count_page_ping\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_ping'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"sum\",\n                \"column_name\": \"page_ping_events_count_last_7_days\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"period\",\n                            \"operator\": \">\",\n                            \"value\": 7\n                        }\n                    ],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": \"geo_country\",\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_geo_country\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_geo_country\",\n                \"modeling_criteria\": {\n                    \"all\": [],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": \"geo_timezone\",\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_geo_timezone\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_timezone\",\n                \"modeling_criteria\": {\n                    \"all\": [],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": \"operating_system_name\",\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_operating_system_name\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_os\",\n                \"modeling_criteria\": {\n                    \"all\": [],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": \"device_class\",\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_device_class\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_device_class\",\n                \"modeling_criteria\": {\n                    \"all\": [],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": \"mkt_source\",\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_mkt_source\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_mkt_source\",\n                \"modeling_criteria\": {\n                    \"all\": [],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": \"mkt_medium\",\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_mkt_medium\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_mkt_medium\",\n                \"modeling_criteria\": {\n                    \"all\": [],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": \"mkt_source\",\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_mkt_source\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_mkt_source\",\n                \"modeling_criteria\": {\n                    \"all\": [],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": \"mkt_medium\",\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_mkt_medium\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_mkt_medium\",\n                \"modeling_criteria\": {\n                    \"all\": [],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": \"refr_source\",\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_refr_source\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_referrer_source\",\n                \"modeling_criteria\": {\n                    \"all\": [],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": \"refr_medium\",\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_refr_medium\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_referrer_medium\",\n                \"modeling_criteria\": {\n                    \"all\": [],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": null,\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"count\",\n                \"column_name\": \"count_page_view_page_url_like_pctpricingpct\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        },\n                        {\n                            \"property\": \"page_url\",\n                            \"operator\": \"like\",\n                            \"value\": \"%pricing%\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"sum\",\n                \"column_name\": \"pricing_pageview_count_last_7_days\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"period\",\n                            \"operator\": \">\",\n                            \"value\": 7\n                        }\n                    ],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": null,\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"count\",\n                \"column_name\": \"count_page_view_page_url_like_pctdemopct\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'page_view'\"\n                        },\n                        {\n                            \"property\": \"page_url\",\n                            \"operator\": \"like\",\n                            \"value\": \"%demo%\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"sum\",\n                \"column_name\": \"demo_pageview_count_last_7_days\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"period\",\n                            \"operator\": \">\",\n                            \"value\": 7\n                        }\n                    ],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": null,\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"count\",\n                \"column_name\": \"media_video_event_count_last_7_days\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'quality_change_event','pause_event','volume_change_event','percent_progress_event','ad_quartile_event','ping_event','seek_start_event','seek_end_event','end_event','ad_start_event','play_event','ready_event','playback_rate_change_event','ad_break_start_event','ad_complete_event','ad_skip_event','buffer_start_event','buffer_end_event','ad_break_end_event'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"sum\",\n                \"column_name\": \"media_video_event_count_last_7_days\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"period\",\n                            \"operator\": \">\",\n                            \"value\": 7\n                        }\n                    ],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": null,\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"count\",\n                \"column_name\": \"count_focus_form_change_form\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'focus_form','change_form'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"sum\",\n                \"column_name\": \"form_focus_change_event_count_last_7_days\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"period\",\n                            \"operator\": \">\",\n                            \"value\": 7\n                        }\n                    ],\n                    \"any\": []\n                }\n            }\n        ],\n        [\n            {\n                \"step_type\": \"filtered_events\",\n                \"enabled\": false,\n                \"aggregation\": null,\n                \"column_name\": \"revenue\",\n                \"modeling_criteria\": null\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"sum\",\n                \"column_name\": \"sum_revenue_snowplow_ecommerce_action\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"event_name\",\n                            \"operator\": \"in\",\n                            \"value\": \"'snowplow_ecommerce_action'\"\n                        }\n                    ],\n                    \"any\": []\n                }\n            },\n            {\n                \"step_type\": \"attribute_aggregation\",\n                \"enabled\": true,\n                \"aggregation\": \"sum\",\n                \"column_name\": \"total_revenue_last_7_days\",\n                \"modeling_criteria\": {\n                    \"all\": [\n                        {\n                            \"property\": \"period\",\n                            \"operator\": \">\",\n                            \"value\": 7\n                        }\n                    ],\n                    \"any\": []\n                }\n            }\n        ]\n    ]\n}"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/configs/dbt_config.json",
      "content": "{\n    \"filtered_events\": {\n        \"events\": [\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.ecommerce\",\n                \"event_name\": \"snowplow_ecommerce_action\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"ad_break_end_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"ad_break_start_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"ad_complete_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"ad_quartile_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"ad_skip_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"ad_start_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"buffer_end_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"buffer_start_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"end_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"pause_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"percent_progress_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"ping_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"play_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"playback_rate_change_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"quality_change_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"ready_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"seek_end_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"seek_start_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow.media\",\n                \"event_name\": \"volume_change_event\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"change_form\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"focus_form\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_ping\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            },\n            {\n                \"event_vendor\": \"com.snowplowanalytics.snowplow\",\n                \"event_name\": \"page_view\",\n                \"event_format\": \"jsonschema\",\n                \"event_version\": \"1-0-0\"\n            }\n        ],\n        \"properties\": [\n            {\n                \"geo_country\": \"geo_country\"\n            },\n            {\n                \"geo_timezone\": \"geo_timezone\"\n            },\n            {\n                \"contexts_nl_basjes_yauaa_context_1[0]:operatingSystemName\": \"operating_system_name\"\n            },\n            {\n                \"contexts_nl_basjes_yauaa_context_1[0]:deviceClass\": \"device_class\"\n            },\n            {\n                \"mkt_source\": \"mkt_source\"\n            },\n            {\n                \"mkt_medium\": \"mkt_medium\"\n            },\n            {\n                \"refr_source\": \"refr_source\"\n            },\n            {\n                \"refr_medium\": \"refr_medium\"\n            },\n            {\n                \"page_url\": \"page_url\"\n            },\n            {\n                \"contexts_com_snowplowanalytics_snowplow_ecommerce_transaction_1[0]:revenue\": \"revenue\"\n            }\n        ]\n    },\n    \"daily_agg\": {\n        \"daily_aggregate_attributes\": [\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"count\",\n                \"column_name\": \"count_page_view\",\n                \"condition_clause\": \"case when  event_name IN('page_view') then 1 else 0 end\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"count\",\n                \"column_name\": \"count_page_ping\",\n                \"condition_clause\": \"case when  event_name IN('page_ping') then 1 else 0 end\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"count\",\n                \"column_name\": \"count_page_view_page_url_like_pctpricingpct\",\n                \"condition_clause\": \"case when  event_name IN('page_view') and  page_url LIKE '%%pricing%%' then 1 else 0 end\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"count\",\n                \"column_name\": \"count_page_view_page_url_like_pctdemopct\",\n                \"condition_clause\": \"case when  event_name IN('page_view') and  page_url LIKE '%%demo%%' then 1 else 0 end\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"count\",\n                \"column_name\": \"media_video_event_count_last_7_days\",\n                \"condition_clause\": \"case when  event_name IN('quality_change_event','pause_event','volume_change_event','percent_progress_event','ad_quartile_event','ping_event','seek_start_event','seek_end_event','end_event','ad_start_event','play_event','ready_event','playback_rate_change_event','ad_break_start_event','ad_complete_event','ad_skip_event','buffer_start_event','buffer_end_event','ad_break_end_event') then 1 else 0 end\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"count\",\n                \"column_name\": \"count_focus_form_change_form\",\n                \"condition_clause\": \"case when  event_name IN('focus_form','change_form') then 1 else 0 end\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"sum\",\n                \"column_name\": \"sum_revenue_snowplow_ecommerce_action\",\n                \"condition_clause\": \"case when  event_name IN('snowplow_ecommerce_action') then cast(revenue as {{ dbt.type_float()}}) else 0 end\"\n            }\n        ],\n        \"daily_first_value_attributes\": [\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_mkt_source\",\n                \"condition_clause\": \"mkt_source\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_mkt_medium\",\n                \"condition_clause\": \"mkt_medium\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_refr_source\",\n                \"condition_clause\": \"refr_source\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"first\",\n                \"column_name\": \"first_refr_medium\",\n                \"condition_clause\": \"refr_medium\"\n            }\n        ],\n        \"daily_last_value_attributes\": [\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_geo_country\",\n                \"condition_clause\": \"geo_country\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_geo_timezone\",\n                \"condition_clause\": \"geo_timezone\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_operating_system_name\",\n                \"condition_clause\": \"operating_system_name\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_device_class\",\n                \"condition_clause\": \"device_class\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_mkt_source\",\n                \"condition_clause\": \"mkt_source\"\n            },\n            {\n                \"step_type\": \"daily_aggregation\",\n                \"aggregation\": \"last\",\n                \"column_name\": \"last_mkt_medium\",\n                \"condition_clause\": \"mkt_medium\"\n            }\n        ]\n    },\n    \"attributes\": {\n        \"lifetime_aggregates\": [],\n        \"last_n_day_aggregates\": [\n            {\n                \"daily_agg_column_name\": \"count_page_view\",\n                \"column_name\": \"page_view_events_count_last_7_days\",\n                \"period\": 7,\n                \"aggregation_type\": \"sum\"\n            },\n            {\n                \"daily_agg_column_name\": \"count_page_ping\",\n                \"column_name\": \"page_ping_events_count_last_7_days\",\n                \"period\": 7,\n                \"aggregation_type\": \"sum\"\n            },\n            {\n                \"daily_agg_column_name\": \"count_page_view_page_url_like_pctpricingpct\",\n                \"column_name\": \"pricing_pageview_count_last_7_days\",\n                \"period\": 7,\n                \"aggregation_type\": \"sum\"\n            },\n            {\n                \"daily_agg_column_name\": \"count_page_view_page_url_like_pctdemopct\",\n                \"column_name\": \"demo_pageview_count_last_7_days\",\n                \"period\": 7,\n                \"aggregation_type\": \"sum\"\n            },\n            {\n                \"daily_agg_column_name\": \"media_video_event_count_last_7_days\",\n                \"column_name\": \"media_video_event_count_last_7_days\",\n                \"period\": 7,\n                \"aggregation_type\": \"sum\"\n            },\n            {\n                \"daily_agg_column_name\": \"count_focus_form_change_form\",\n                \"column_name\": \"form_focus_change_event_count_last_7_days\",\n                \"period\": 7,\n                \"aggregation_type\": \"sum\"\n            },\n            {\n                \"daily_agg_column_name\": \"sum_revenue_snowplow_ecommerce_action\",\n                \"column_name\": \"total_revenue_last_7_days\",\n                \"period\": 7,\n                \"aggregation_type\": \"sum\"\n            }\n        ],\n        \"first_value_attributes\": [\n            {\n                \"daily_agg_column_name\": \"first_mkt_source\",\n                \"column_name\": \"first_mkt_source\",\n                \"period\": null,\n                \"aggregation_type\": \"first\"\n            },\n            {\n                \"daily_agg_column_name\": \"first_mkt_medium\",\n                \"column_name\": \"first_mkt_medium\",\n                \"period\": null,\n                \"aggregation_type\": \"first\"\n            },\n            {\n                \"daily_agg_column_name\": \"first_refr_source\",\n                \"column_name\": \"first_referrer_source\",\n                \"period\": null,\n                \"aggregation_type\": \"first\"\n            },\n            {\n                \"daily_agg_column_name\": \"first_refr_medium\",\n                \"column_name\": \"first_referrer_medium\",\n                \"period\": null,\n                \"aggregation_type\": \"first\"\n            }\n        ],\n        \"last_value_attributes\": [\n            {\n                \"daily_agg_column_name\": \"last_geo_country\",\n                \"column_name\": \"last_geo_country\",\n                \"period\": null,\n                \"aggregation_type\": \"last\"\n            },\n            {\n                \"daily_agg_column_name\": \"last_geo_timezone\",\n                \"column_name\": \"last_timezone\",\n                \"period\": null,\n                \"aggregation_type\": \"last\"\n            },\n            {\n                \"daily_agg_column_name\": \"last_operating_system_name\",\n                \"column_name\": \"last_os\",\n                \"period\": null,\n                \"aggregation_type\": \"last\"\n            },\n            {\n                \"daily_agg_column_name\": \"last_device_class\",\n                \"column_name\": \"last_device_class\",\n                \"period\": null,\n                \"aggregation_type\": \"last\"\n            },\n            {\n                \"daily_agg_column_name\": \"last_mkt_source\",\n                \"column_name\": \"last_mkt_source\",\n                \"period\": null,\n                \"aggregation_type\": \"last\"\n            },\n            {\n                \"daily_agg_column_name\": \"last_mkt_medium\",\n                \"column_name\": \"last_mkt_medium\",\n                \"period\": null,\n                \"aggregation_type\": \"last\"\n            }\n        ]\n    }\n}"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/models/daily_aggregates/ecommerce_transaction_interactions_features_1_daily_aggregates.sql",
      "content": "\n{#\nCopyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{{\n  config(\n    materialized='incremental',\n    sort='event_date',\n    dist='domain_userid',\n    partition_by = snowplow_utils.get_value_by_target_type(bigquery_val = {\n      \"field\": \"event_date\",\n      \"data_type\": \"date\"\n    }, databricks_val='event_date'),\n    unique_key='user_date_id',\n    upsert_date_key='event_date',\n    tags=[\"derived\"],\n    on_schema_change='append_new_columns',\n    cluster_by=snowplow_utils.get_value_by_target_type(bigquery_val=[\"event_date\",\"domain_userid\"], snowflake_val=[\"event_date\"]),\n    sql_header=snowplow_utils.set_query_tag(var('snowplow__query_tag', 'snowplow_dbt')),\n    tblproperties={\n      'delta.autoOptimize.optimizeWrite' : 'true',\n      'delta.autoOptimize.autoCompact' : 'true'\n    },\n    snowplow_optimize = true\n  )\n}}\n\nselect * from\n{{ ref('ecommerce_transaction_interactions_features_1_daily_aggregates_this_run') }}\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/models/attributes/ecommerce_transaction_interactions_features_1_attributes.sql",
      "content": "\n{#\nCopyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{{\n  config(\n    materialized='table',\n    dist='domain_userid',\n    partition_by = snowplow_utils.get_value_by_target_type(bigquery_val = {\n      \"field\": \"last_event_tstamp\",\n      \"data_type\": \"timestamp\"\n    }, databricks_val='last_event_date'),\n    sql_header=snowplow_utils.set_query_tag(var('snowplow__query_tag', 'snowplow_dbt')),\n  )\n}}\n\n{%- set lower_limit, upper_limit = get_limits_for_attributes() %}\n\nwith aggregations as (\n\n  select \n    domain_userid\n\n    \n    \n      , sum(case when event_date >= {{dbt.dateadd('day', -7, upper_limit)}} then count_page_view end) as page_view_events_count_last_7_days\n    \n      , sum(case when event_date >= {{dbt.dateadd('day', -7, upper_limit)}} then count_page_ping end) as page_ping_events_count_last_7_days\n    \n      , sum(case when event_date >= {{dbt.dateadd('day', -7, upper_limit)}} then count_page_view_page_url_like_pctpricingpct end) as pricing_pageview_count_last_7_days\n    \n      , sum(case when event_date >= {{dbt.dateadd('day', -7, upper_limit)}} then count_page_view_page_url_like_pctdemopct end) as demo_pageview_count_last_7_days\n    \n      , sum(case when event_date >= {{dbt.dateadd('day', -7, upper_limit)}} then media_video_event_count_last_7_days end) as media_video_event_count_last_7_days\n    \n      , sum(case when event_date >= {{dbt.dateadd('day', -7, upper_limit)}} then count_focus_form_change_form end) as form_focus_change_event_count_last_7_days\n    \n      , sum(case when event_date >= {{dbt.dateadd('day', -7, upper_limit)}} then sum_revenue_snowplow_ecommerce_action end) as total_revenue_last_7_days\n    \n\n\n  from {{ ref('ecommerce_transaction_interactions_features_1_daily_aggregates')}}\n\n  group by 1\n  \n)\n\n, window_calculations as (\n  \n  select distinct\n    domain_userid\n\n\n  \n    , first_value(first_mkt_source) over (\n                partition by domain_userid \n                order by last_event_tstamp ASC\n            ) as first_mkt_source\n  \n\n  \n    , first_value(first_mkt_medium) over (\n                partition by domain_userid \n                order by last_event_tstamp ASC\n            ) as first_mkt_medium\n  \n\n  \n    , first_value(first_refr_source) over (\n                partition by domain_userid \n                order by last_event_tstamp ASC\n            ) as first_referrer_source\n  \n\n  \n    , first_value(first_refr_medium) over (\n                partition by domain_userid \n                order by last_event_tstamp ASC\n            ) as first_referrer_medium\n  \n\n\n  \n    , last_value(last_geo_country) over (\n                partition by domain_userid \n                order by last_event_tstamp ASC\n            ) as last_geo_country\n  \n\n  \n    , last_value(last_geo_timezone) over (\n                partition by domain_userid \n                order by last_event_tstamp ASC\n            ) as last_timezone\n  \n\n  \n    , last_value(last_operating_system_name) over (\n                partition by domain_userid \n                order by last_event_tstamp ASC\n            ) as last_os\n  \n\n  \n    , last_value(last_device_class) over (\n                partition by domain_userid \n                order by last_event_tstamp ASC\n            ) as last_device_class\n  \n\n  \n    , last_value(last_mkt_source) over (\n                partition by domain_userid \n                order by last_event_tstamp ASC\n            ) as last_mkt_source\n  \n\n  \n    , last_value(last_mkt_medium) over (\n                partition by domain_userid \n                order by last_event_tstamp ASC\n            ) as last_mkt_medium\n  \n\n\n  from {{ ref('ecommerce_transaction_interactions_features_1_daily_aggregates')}}\n  \n)\n\nselect\n    \n  w.domain_userid,\n  current_timestamp() as valid_at_tstamp,\n  cast({{ lower_limit }} as date) as lower_limit,\n  cast({{ upper_limit }} as date) as upper_limit\n\n  \n    , w.first_mkt_source\n    , w.first_mkt_medium\n    , w.first_referrer_source\n    , w.first_referrer_medium\n\n  -- time window based attributes\n  \n    , page_view_events_count_last_7_days\n  \n    , page_ping_events_count_last_7_days\n  \n    , pricing_pageview_count_last_7_days\n  \n    , demo_pageview_count_last_7_days\n  \n    , media_video_event_count_last_7_days\n  \n    , form_focus_change_event_count_last_7_days\n  \n    , total_revenue_last_7_days\n  \n    \n  -- lifetime based attributes\n  \n\n  -- user lasts\n  \n    , w.last_geo_country\n    , w.last_timezone\n    , w.last_os\n    , w.last_device_class\n    , w.last_mkt_source\n    , w.last_mkt_medium\n\nfrom aggregations as a\n\nleft join window_calculations as w\non a.domain_userid = w.domain_userid\n\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/models/filtered_events/ecommerce_transaction_interactions_features_1_filtered_events.sql",
      "content": "\n{#\nCopyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n{{ config(\n    materialized = \"incremental\",\n    unique_key = \"event_id\",\n    upsert_date_key = \"derived_tstamp\",\n    partition_by = snowplow_utils.get_value_by_target_type(\n        bigquery_val={\n        \"field\": \"derived_tstamp\",\n        \"data_type\": \"timestamp\"\n    }, \n    databricks_val='derived_tstamp_date'),\n    sql_header=snowplow_utils.set_query_tag(var('snowplow__query_tag', 'snowplow_dbt')),\n    tblproperties={\n      'delta.autoOptimize.optimizeWrite' : 'true',\n      'delta.autoOptimize.autoCompact' : 'true'\n    },\n    snowplow_optimize=true\n) }}\n\nselect *\n    \nfrom {{ ref('ecommerce_transaction_interactions_features_1_filtered_events_this_run') }}\nwhere {{ snowplow_utils.is_run_with_new_events(\"ecommerce_transaction_interactions_features_1\"\n        , new_event_limits_table=\"ecommerce_transaction_interactions_features_1_base_new_event_limits\"\n        , incremental_manifest_table=\"ecommerce_transaction_interactions_features_1_incremental_manifest\"\n        , base_sessions_lifecycle_table=\"ecommerce_transaction_interactions_features_1_base_sessions_lifecycle\"\n        ) }}\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/models/daily_aggregates/manifest/ecommerce_transaction_interactions_features_1_daily_aggregation_manifest.sql",
      "content": "\n{#\nCopyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{#\n    Dynamic manifest that tracks all daily metrics models.\n    Dependencies must be declared statically for dbt's DAG.\n#}\n\n-- depends_on: {{ ref('ecommerce_transaction_interactions_features_1_daily_aggregates_this_run') }}\n-- depends_on: {{ ref('ecommerce_transaction_interactions_features_1_filtered_events_this_run') }}\n-- depends_on: {{ ref('ecommerce_transaction_interactions_features_1_filtered_events') }}\n-- depends_on: {{ ref('ecommerce_transaction_interactions_features_1_daily_aggregates') }}\n\n{{\n    config(\n        materialized='incremental',\n        unique_key=['event_date', 'source_model'],\n        on_schema_change='sync_all_columns',\n        sql_header=snowplow_utils.set_query_tag(var('snowplow__query_tag', 'snowplow_dbt')))\n}}\n\n{% set daily_aggregation_manifest_query = snowplow_utils.create_daily_aggregation_manifest('ecommerce_transaction_interactions_features_1') %}\n\n{{ daily_aggregation_manifest_query }}\n\n "
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/models/daily_aggregates/scratch/ecommerce_transaction_interactions_features_1_days_to_process.sql",
      "content": "\n{#\nCopyright (c) 2023-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{{\n    config(\n        materialized='table',\n        tags=['snowplow_autogen', 'dates_to_process'],\n        sql_header=snowplow_utils.set_query_tag(var('snowplow__query_tag', 'snowplow_dbt')),\n        post_hook=[\n            \"{{ snowplow_utils.print_dates_to_process() }}\"\n        ]\n    )\n}}\n\n{% set dates_to_process_query = snowplow_utils.get_dates_to_process(\n    'ecommerce_transaction_interactions_features_1_filtered_events_this_run',\n    'ecommerce_transaction_interactions_features_1_daily_aggregation_manifest'\n) %}\n\n{{ dates_to_process_query }}\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/models/daily_aggregates/scratch/ecommerce_transaction_interactions_features_1_daily_aggregates_this_run.sql",
      "content": "\n{#Copyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{{\n    config(\n        tags=[\"this_run\"],\n        materialized=\"table\",\n        sql_header=snowplow_utils.set_query_tag(var('snowplow__query_tag', 'snowplow_dbt')),\n        unique_key=['user_date_id']\n    )\n}}\n\nwith events as (\n  select e.* \n  from {{ ref('ecommerce_transaction_interactions_features_1_filtered_events') }} e\n  inner join {{ ref('ecommerce_transaction_interactions_features_1_days_to_process') }} d\n      on date(e.derived_tstamp) = d.event_date\n)\n\n, aggregations as (\n  \n  select\n    {{ dbt_utils.generate_surrogate_key(['domain_userid', 'event_date']) }} user_date_id,\n    domain_userid,\n    event_date\n    \n    \n      \n        , sum(\n      \n        case when  event_name IN('page_view') then 1 else 0 end) as count_page_view\n    \n      \n        , sum(\n      \n        case when  event_name IN('page_ping') then 1 else 0 end) as count_page_ping\n    \n      \n        , sum(\n      \n        case when  event_name IN('page_view') and  page_url LIKE '%%pricing%%' then 1 else 0 end) as count_page_view_page_url_like_pctpricingpct\n    \n      \n        , sum(\n      \n        case when  event_name IN('page_view') and  page_url LIKE '%%demo%%' then 1 else 0 end) as count_page_view_page_url_like_pctdemopct\n    \n      \n        , sum(\n      \n        case when  event_name IN('quality_change_event','pause_event','volume_change_event','percent_progress_event','ad_quartile_event','ping_event','seek_start_event','seek_end_event','end_event','ad_start_event','play_event','ready_event','playback_rate_change_event','ad_break_start_event','ad_complete_event','ad_skip_event','buffer_start_event','buffer_end_event','ad_break_end_event') then 1 else 0 end) as media_video_event_count_last_7_days\n    \n      \n        , sum(\n      \n        case when  event_name IN('focus_form','change_form') then 1 else 0 end) as count_focus_form_change_form\n    \n      \n        , sum(\n      \n        case when  event_name IN('snowplow_ecommerce_action') then cast(revenue as {{ dbt.type_float()}}) else 0 end) as sum_revenue_snowplow_ecommerce_action\n    \n    \n  from events\n  group by 1,2,3\n)\n\n--TODO: consider separating them to user_lasts and user_firsts to avoid having to do multiple window functions if these fields get bigger and the query optimizer does not catch them\n, window_calculations as (\n  \n  select\n    *,\n    last_value(derived_tstamp) over (partition by user_date_id order by derived_tstamp) as last_event_tstamp\n        \n    \n      , first_value(mkt_source) over (partition by user_date_id order by derived_tstamp) as first_mkt_source\n      , first_value(mkt_medium) over (partition by user_date_id order by derived_tstamp) as first_mkt_medium\n      , first_value(refr_source) over (partition by user_date_id order by derived_tstamp) as first_refr_source\n      , first_value(refr_medium) over (partition by user_date_id order by derived_tstamp) as first_refr_medium\n    \n      , last_value(geo_country) over (partition by user_date_id order by derived_tstamp) as last_geo_country\n      , last_value(geo_timezone) over (partition by user_date_id order by derived_tstamp) as last_geo_timezone\n      , last_value(operating_system_name) over (partition by user_date_id order by derived_tstamp) as last_operating_system_name\n      , last_value(device_class) over (partition by user_date_id order by derived_tstamp) as last_device_class\n      , last_value(mkt_source) over (partition by user_date_id order by derived_tstamp) as last_mkt_source\n      , last_value(mkt_medium) over (partition by user_date_id order by derived_tstamp) as last_mkt_medium\n  \n  from events\n  \n)\n\nselect distinct\n  a.user_date_id,\n  a.domain_userid,\n  a.event_date,\n  w.last_event_tstamp\n\n    \n    , a.count_page_view\n  \n    , a.count_page_ping\n  \n    , a.count_page_view_page_url_like_pctpricingpct\n  \n    , a.count_page_view_page_url_like_pctdemopct\n  \n    , a.media_video_event_count_last_7_days\n  \n    , a.count_focus_form_change_form\n  \n    , a.sum_revenue_snowplow_ecommerce_action\n  \n  \n    \n    , w.first_mkt_source\n    , w.first_mkt_medium\n    , w.first_refr_source\n    , w.first_refr_medium\n  \n    \n    , w.last_geo_country\n    , w.last_geo_timezone\n    , w.last_operating_system_name\n    , w.last_device_class\n    , w.last_mkt_source\n    , w.last_mkt_medium\n\nfrom aggregations a\n\nleft join window_calculations w\non w.user_date_id = a.user_date_id\n\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/models/filtered_events/scratch/ecommerce_transaction_interactions_features_1_filtered_events_this_run.sql",
      "content": "{#\nCopyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{{\n    config(\n        tags=[\"this_run\"],\n        materialized=\"table\",\n        sql_header=snowplow_utils.set_query_tag(var('snowplow__query_tag', 'snowplow_dbt'))\n    )\n}}\n\nselect\n    event_id,\n    domain_userid,\n    derived_tstamp,\n    date(derived_tstamp) as event_date,\n    load_tstamp,\n    {{ dbt_utils.generate_surrogate_key(['domain_userid', 'event_date']) }} AS user_date_id,\n    event_name,\n    geo_country AS geo_country,\n    geo_timezone AS geo_timezone,\n    contexts_nl_basjes_yauaa_context_1[0]:operatingSystemName AS operating_system_name,\n    contexts_nl_basjes_yauaa_context_1[0]:deviceClass AS device_class,\n    mkt_source AS mkt_source,\n    mkt_medium AS mkt_medium,\n    refr_source AS refr_source,\n    refr_medium AS refr_medium,\n    page_url AS page_url,\n    contexts_com_snowplowanalytics_snowplow_ecommerce_transaction_1[0]:revenue AS revenue\n    \n\nfrom\n    {{ ref('ecommerce_transaction_interactions_features_1_base_events_this_run') }}\nwhere \n    (event_name = 'snowplow_ecommerce_action'\n        and event_vendor = 'com.snowplowanalytics.snowplow.ecommerce'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'ad_break_end_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'ad_break_start_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'ad_complete_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'ad_quartile_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'ad_skip_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'ad_start_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'buffer_end_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'buffer_start_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'end_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'pause_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'percent_progress_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'ping_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'play_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'playback_rate_change_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'quality_change_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'ready_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'seek_end_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'seek_start_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'volume_change_event'\n        and event_vendor = 'com.snowplowanalytics.snowplow.media'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'change_form'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'focus_form'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_ping'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    ) or \n\n\n    (event_name = 'page_view'\n        and event_vendor = 'com.snowplowanalytics.snowplow'\n        and event_version = '1-0-0'\n    )\n\n\n    \n    and {{ snowplow_utils.is_run_with_new_events(\"ecommerce_transaction_interactions_features_1\"\n        , new_event_limits_table=\"ecommerce_transaction_interactions_features_1_base_new_event_limits\"\n        , incremental_manifest_table=\"ecommerce_transaction_interactions_features_1_incremental_manifest\"\n        , base_sessions_lifecycle_table=\"ecommerce_transaction_interactions_features_1_base_sessions_lifecycle\"\n        ) }}\n\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/models/base/manifest/ecommerce_transaction_interactions_features_1_incremental_manifest.sql",
      "content": "{#\nCopyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{{\n  config(\n    materialized='incremental',\n    sql_header=snowplow_utils.set_query_tag(var('snowplow__query_tag', 'snowplow_dbt')),\n    tblproperties={\n      'delta.autoOptimize.optimizeWrite' : 'true',\n      'delta.autoOptimize.autoCompact' : 'true'\n    },\n  )\n}}\n\n{% set incremental_manifest_query = snowplow_utils.base_create_snowplow_incremental_manifest_t() %}\n\n{{ incremental_manifest_query }}\n\n{# TODO: add full refresh in config! #}\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/models/base/scratch/ecommerce_transaction_interactions_features_1_base_new_event_limits.sql",
      "content": "\n{#\nCopyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{{ config(\n   post_hook=[\"{{snowplow_utils.print_run_limits(this, 'ecommerce_transaction_interactions_features_1')}}\"],\n   sql_header=snowplow_utils.set_query_tag(var('snowplow__query_tag', 'snowplow_dbt'))\n   )\n}}\n\n\n{%- set models_in_run = snowplow_utils.get_enabled_snowplow_models('ecommerce_transaction_interactions_features_1', base_events_table_name='ecommerce_transaction_interactions_features_1_snowplow_base_events_this_run') -%}\n\n{% set min_first_processed_load_tstamp,\n      max_first_processed_load_tstamp,\n      min_last_processed_load_tstamp,\n      max_last_processed_load_tstamp,\n      models_matched_from_manifest,\n      sync_count,\n      has_matched_all_models = snowplow_utils.get_incremental_manifest_status_t(ref('ecommerce_transaction_interactions_features_1_incremental_manifest'),\n                                                                                 models_in_run) -%}\n\n{% set run_limits_query = snowplow_utils.get_run_limits_t(min_first_processed_load_tstamp,\n                                                         max_first_processed_load_tstamp,\n                                                         min_last_processed_load_tstamp,\n                                                         max_last_processed_load_tstamp,\n                                                         models_matched_from_manifest,\n                                                         sync_count,\n                                                         has_matched_all_models,\n                                                         var(\"snowplow__start_date\",\"2024-01-01\")) -%}\n\n{{ run_limits_query }}\n"
    },
    {
      "path": "ecommerce_transaction_interactions_features_1/models/base/scratch/ecommerce_transaction_interactions_features_1_base_events_this_run.sql",
      "content": "{#\nCopyright (c) 2025-present Snowplow Analytics Ltd. All rights reserved.\nThis program is licensed to you under the Snowplow Personal and Academic License Version 1.0,\nand you may not use this file except in compliance with the Snowplow Personal and Academic License Version 1.0.\nYou may obtain a copy of the Snowplow Personal and Academic License Version 1.0 at https://docs.snowplow.io/personal-and-academic-license-1.0/\n#}\n\n{{\n  config(\n    sort='load_tstamp',\n    dist='event_id',\n    tags=[\"this_run\"]\n  )\n}}\n\n{% set base_events_query = snowplow_utils.base_create_snowplow_events_this_run_t(\n                              run_limits_table='ecommerce_transaction_interactions_features_1_base_new_event_limits',\n                              app_ids=var('snowplow__app_id', []),\n                              snowplow_events_database=var('snowplow__database', target.database) if target.type not in ['databricks', 'spark'] else var('snowplow__databricks_catalog', 'hive_metastore') if target.type in ['databricks'] else var('snowplow__atomic_schema', 'atomic'),\n                              snowplow_events_schema=var('snowplow__atomic_schema', 'atomic'),\n                              snowplow_events_table=var('snowplow__events_table', 'events'),\n                              event_names=var('snowplow__events_to_include', [])\n                              ) %}\n\n{{ base_events_query }}\n"
    }
  ]
}